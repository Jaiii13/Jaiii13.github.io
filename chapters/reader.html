<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Chapter reader</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{--bg:#000;--card:#0b0b0b;--text:#eee;--muted:#aaa}
  html,body{height:100%;margin:0}
  body{background:var(--bg);color:var(--text);font-family:system-ui,Arial;padding:28px;display:flex;justify-content:center}
  .wrap{max-width:760px;width:100%}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:20px;border-radius:10px}
  h1{margin:0 0 8px;font-size:1.2rem}
  .meta{color:var(--muted);font-size:0.9rem;margin-bottom:14px}
  #content{line-height:1.7;color:var(--text);white-space:normal}
  nav{display:flex;justify-content:space-between;margin-top:20px}
  a{color:var(--text);text-decoration:none;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:8px}
  a[disabled]{opacity:.35;pointer-events:none}
  p{margin:0 0 1em}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1 id="title">Loading…</h1>
        <div class="meta" id="meta">Translator · Published</div>
      </header>

      <section id="content">Loading text…</section>

      <nav id="nav">
        <a id="prev" href="#">← Prev</a>
        <a href="/" id="home">Home</a>
        <a id="next" href="#">Next →</a>
      </nav>
    </div>
  </div>

<script>
(function(){
  const params = new URLSearchParams(location.search);
  let n = parseInt(params.get('n'),10) || 490;
  const first = 490, last = 710;
  if(n<first) n = first;
  if(n>last) n = last;

  const titleEl = document.getElementById('title');
  const contentEl = document.getElementById('content');
  const prevEl = document.getElementById('prev');
  const nextEl = document.getElementById('next');

  titleEl.textContent = `Chapter ${n}`;
  // set nav
  if(n>first) prevEl.href = `reader.html?n=${n-1}`; else prevEl.setAttribute('disabled','');
  if(n<last) nextEl.href = `reader.html?n=${n+1}`; else nextEl.setAttribute('disabled','');

  const txtFile = `ch${n}.txt`; // load chapters/ch490.txt etc
  fetch(txtFile).then(r=>{
    if(!r.ok) throw new Error('Not found');
    return r.text();
  }).then(t=>{
    // Trim; split on two or more newlines -> paragraph
    const paragraphs = t.trim().split(/\n{2,}/g).map(p=>{
      // single newlines -> <br>
      return '<p>' + p.replace(/\n/g,'<br>') + '</p>';
    }).join('');
    contentEl.innerHTML = paragraphs;
  }).catch(e=>{
    contentEl.innerHTML = '<p style="color:#f88">Text file not found. Create '+txtFile+' and paste your chapter text into it.</p>';
  });
})();
</script>
</body>
</html>
