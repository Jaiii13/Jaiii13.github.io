<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Vasava — Translations & Art</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{
    --bg:#f6efe6; --card:#fff7ef; --text:#2b2b2b; --muted:#7a6a5a;
    --accent:#b86bff; --radius:12px;
  }
  [data-theme="dark"]{
    --bg:#0f0e0c; --card:#141312; --text:#efe8dd; --muted:#b9a89a; --accent:#b86bff;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial;display:flex;justify-content:center;padding:32px}
  .wrap{width:100%;max-width:980px}
  .panel{background:var(--card);border-radius:var(--radius);padding:20px;box-shadow:0 10px 28px rgba(34,30,26,0.06);border:1px solid rgba(0,0,0,0.03)}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:76px;height:76px;border-radius:10px;overflow:hidden;flex:0 0 76px;display:block}
  .logo img{width:100%;height:100%;object-fit:cover;display:block}
  h1{margin:0;font-size:1.15rem}
  .sub{color:var(--muted);font-size:0.95rem;margin-top:6px}
  .controls{display:flex;gap:8px;align-items:center}
  .btn{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 10px;border-radius:8px;cursor:pointer}
  .hero{margin-top:14px;padding:14px;border-radius:10px;background:linear-gradient(180deg,rgba(184,107,255,0.04),rgba(255,184,107,0.02));display:flex;justify-content:space-between;align-items:center}
  .collections{margin-top:12px;display:flex;flex-direction:column;gap:12px}
  .collection{padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.04);background:transparent}
  .coll-head{display:flex;justify-content:space-between;align-items:center;gap:8px;cursor:pointer}
  .coll-list{margin-top:10px;display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:8px;max-height:0;overflow:hidden;transition:max-height .28s ease,opacity .2s;opacity:0}
  .coll-list.open{max-height:520px;opacity:1}
  a.link{display:block;padding:8px;border-radius:8px;text-decoration:none;text-align:center;border:1px solid rgba(0,0,0,0.03);color:var(--text);background:transparent}
  a.link:hover{background:rgba(0,0,0,0.03)}
  .actions{margin-top:12px;display:flex;gap:8px;align-items:center}
  input[type=number],input[type=search]{padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text)}
  .note{margin-top:12px;color:var(--muted);font-size:0.92rem}
  @media (max-width:720px){ .coll-list{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))} .logo{width:56px;height:56px} }
</style>
</head>
<body>
  <main class="wrap">
    <section class="panel" aria-labelledby="site-title">
      <header>
        <div class="brand">
          <a class="logo" href="/" aria-label="Vasava home">
            <img src="assets/logo.png" alt="Vasava logo">
          </a>
          <div>
            <h1 id="site-title">Vasava</h1>
            <div class="sub">Translations • Photography • Art — community-run</div>
          </div>
        </div>

        <div class="controls" role="toolbar" aria-label="site controls">
          <button id="themeToggle" class="btn" aria-pressed="false">Dark</button>
        </div>
      </header>

      <section class="hero" aria-label="intro">
        <div>
          <strong>All content free. Repo public. Community contributions welcome.</strong>
          <div class="note">To help translate or contribute art, DM <strong>jaide.e</strong> on Discord.</div>
        </div>
        <div style="text-align:right">
          <a class="btn" href="chapters/reader.html?n=490">Open first</a>
        </div>
      </section>

      <div class="collections" id="collections" aria-live="polite">
        <!-- collections rendered here -->
      </div>

      <div class="actions">
        <div style="display:flex;gap:8px;align-items:center">
          <input id="jump" type="number" min="1" placeholder="Chapter" aria-label="Jump to chapter">
          <button id="jumpBtn" class="btn">Open</button>
        </div>

        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <input id="search" type="search" placeholder="Search (press F)" aria-label="Search chapters">
          <button id="searchBtn" class="btn">Go</button>
        </div>
      </div>

      <div class="note">Keyboard: <kbd>O</kbd> toggle first collection, <kbd>F</kbd> focus search. Hover a chapter to prefetch.</div>
    </section>
  </main>

<script>
/* CONFIG: collections array. Add more collections later. Keep metadata minimal. */
const collections = [
  { id:'ofpv', title:'OFPV', from:490, to:586, description:'Main OFPV run' },
  // { id:'photog', title:'Photography', from:null, to:null, gallery:true }
];

/* RENDER collections */
const root = document.documentElement;
const container = document.getElementById('collections');
collections.forEach(col => {
  const el = document.createElement('div');
  el.className = 'collection';
  el.innerHTML = `
    <div class="coll-head" data-id="${col.id}">
      <div><strong>${col.title}</strong> ${col.from && col.to ? `<span style="color:var(--muted)">(${col.from}–${col.to})</span>` : ''}</div>
      <div class="muted">${col.description || ''}</div>
    </div>
    <div class="coll-list" id="list-${col.id}" aria-hidden="true"></div>
  `;
  container.appendChild(el);

  const list = el.querySelector('.coll-list');
  if(!col.gallery && col.from && col.to){
    for(let i=col.from;i<=col.to;i++){
      const a = document.createElement('a');
      a.className = 'link';
      a.href = `chapters/reader.html?n=${i}`;
      a.textContent = `Ch ${i}`;
      a.addEventListener('mouseenter', ()=>prefetch(a.href));
      list.appendChild(a);
    }
  } else if(col.gallery){
    // placeholder for future gallery items
    const p = document.createElement('div');
    p.textContent = 'Gallery coming soon.';
    list.appendChild(p);
  }

  el.querySelector('.coll-head').addEventListener('click', ()=>{
    const open = list.classList.toggle('open');
    list.setAttribute('aria-hidden', !open);
    if(open) list.scrollIntoView({behavior:'smooth', block:'center'});
  });
  el.querySelector('.coll-head').addEventListener('dblclick', ()=>{
    if(col.from) location.href = `chapters/reader.html?n=${col.from}`;
  });
});

/* THEME */
const storedTheme = localStorage.getItem('vasava-theme');
const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
root.setAttribute('data-theme', storedTheme || (prefersDark ? 'dark' : ''));
const themeBtn = document.getElementById('themeToggle');
function updateThemeBtn(){ themeBtn.textContent = root.getAttribute('data-theme') === 'dark' ? 'Light' : 'Dark'; themeBtn.setAttribute('aria-pressed', root.getAttribute('data-theme')==='dark'); }
themeBtn.addEventListener('click', ()=>{ const next = root.getAttribute('data-theme')==='dark' ? 'light' : 'dark'; root.setAttribute('data-theme', next); localStorage.setItem('vasava-theme', next); updateThemeBtn(); });
updateThemeBtn();

/* JUMP & SEARCH */
document.getElementById('jumpBtn').addEventListener('click', ()=>{
  const n = Number(document.getElementById('jump').value);
  if(!n){ alert('Enter chapter number'); return; }
  location.href = `chapters/reader.html?n=${n}`;
});
document.getElementById('searchBtn').addEventListener('click', ()=>{
  const q = document.getElementById('search').value.trim();
  if(!q) return;
  const num = Number(q);
  if(num){ location.href = `chapters/reader.html?n=${num}`; return; }
  const found = Array.from(document.querySelectorAll('.link')).find(a=>a.textContent.toLowerCase().includes(q.toLowerCase()));
  if(found) location.href = found.href; else alert('No match. Try a chapter number or part of "Ch N".');
});

/* KEYBOARD shortcuts */
document.addEventListener('keydown', (e)=>{
  if(e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') return;
  if(e.key === 'o' || e.key === 'O'){ // toggle first collection
    const first = collections[0];
    if(!first) return;
    const el = document.getElementById('list-'+first.id);
    if(el) el.classList.toggle('open');
  }
  if(e.key === 'f' || e.key === 'F'){ document.getElementById('search').focus(); e.preventDefault(); }
});

/* PREFETCH helper */
const prefetchSet = new Set();
function prefetch(url){
  if(prefetchSet.has(url)) return;
  prefetchSet.add(url);
  const l = document.createElement('link'); l.rel='prefetch'; l.href = url; document.head.appendChild(l);
}
</script>
</body>
</html>
